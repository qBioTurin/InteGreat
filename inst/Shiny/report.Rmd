---
title: "Report Omni Reproducible Cell Analysis"
date: "`r Sys.Date()`"
output: pdf_document
params:
   ResultList: list()
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(ggplot2)
library(DT)
library(dplyr)
ResultList <- params$ResultList

```

## ELISA

### Initial Data

```{r, echo=FALSE}
if (!is.null(ResultList$elisaResult[["TablePlot"]])) {
  DT::datatable(ResultList$elisaResult[["TablePlot"]])
}
```

### Regression analysis

```{r, echo=FALSE}
if (!is.null(ResultList$elisaResult[["Tablestandcurve"]])) {
  DT::datatable(ResultList$elisaResult[["Tablestandcurve"]])
}

if (!is.null(ResultList$elisaResult[["Regression"]])) {
  regressionData <- ResultList$elisaResult[["Regression"]]$data
  regressionPlot <- ResultList$elisaResult[["Regression"]]$plot
  
  if (!is.null(regressionData)) {
    DT::datatable(regressionData)
  }
  
  if (!is.null(regressionPlot)) {
    print(regressionPlot)
  }
}

```


### Analysis

```{r, echo=FALSE}

if (!is.null(ResultList$elisaResult[["dataFinal"]])) {
  finalData <- ResultList$elisaResult[["dataFinal"]]
  ggplot(finalData, aes(x = Time, y = Quantification, fill = Experiment, group = Experiment)) +
    geom_bar(position = "dodge", stat = "identity") +
    theme_bw() +
    labs(x = "Time", y = "Average quantifications obtained\nfrom the lm", fill = "Experiment", group = "Experiment")
}

```

## Cytotoxicity

### initial data

```{r, echo=FALSE}
if (!is.null(ResultList$cytotoxResult[["TablePlot"]])) {
  DT::datatable(ResultList$cytotoxResult[["TablePlot"]])
}
```

### Analysis

```{r, echo=FALSE}

if (!is.null(ResultList$cytotoxResult[["dataFinal"]])) {
  finalData <- ResultList$cytotoxResult[["dataFinal"]]
  DT::datatable(finalData)
  
  if (!is.null(finalData)) {
    ggplot(finalData, aes(x = as.factor(EXP), y = Res, fill = SN, col = SN)) +
      geom_boxplot(alpha = 0.4) +
      theme_bw() +
      labs(x = "Experimental condition", y = "% Values w.r.t the baseline cell death", fill = "Sample Name", color = "Sample Name")
  }
}

```


## Endocytosis

### Initial data

```{r, echo=FALSE} 
if (!is.null(ResultList$endocResult[["TablePlot"]])) {
  DT::datatable(ResultList$endocResult[["TablePlot"]])
}
```

### Analysis
```{r, echo=FALSE}    
if (!is.null(ResultList$endocResult[["dataFinal"]])) {
  DT::datatable(ResultList$endocResult[["dataFinal"]])
}
```

## RT-qPCR

### Initial data

```{r, echo=FALSE}
if (!is.null(ResultList$pcrResult[["Initdata"]])) {
  DT::datatable(ResultList$pcrResult[["Initdata"]])
}
```

## Normalization on Housekeeping Genes

```{r, echo=FALSE}

if (!is.null(ResultList$pcrResult[["NewPCR"]])) {
  DT::datatable(ResultList$pcrResult[["NewPCR"]])
}

if (!is.null(ResultList$pcrResult[["plotPRC"]])) {
  print(ResultList$pcrResult[["plotPRC"]])
}

```

<!-- ### Comp Analysis -->

<!-- ```{r, echo=FALSE} -->

<!-- ResultList$pcrResult[["CompPRC"]] -->

<!-- ggplot(data =  ResultList$pcrResult[["CompPRC"]], -->
<!--                   aes(x= Gene, y = Qnorm, fill = Sample)) +  -->
<!--              facet_wrap(~Norm, ncol = 1) + -->
<!--              geom_bar(stat = "identity",position = "dodge") -->


<!-- ``` -->

### WB

### Initial data

```{r, echo=FALSE}
    
if (!is.null(ResultList$pcrResult[["NewPCR"]])) {
  DT::datatable(ResultList$pcrResult[["NewPCR"]])
}

if (!is.null(ResultList$pcrResult[["plotPRC"]])) {
  print(ResultList$pcrResult[["plotPRC"]])
}

```

### Analysis
```{r, echo=FALSE}   
if (!is.null(ResultList$wbResult[["Plots"]])) {
  print(ResultList$wbResult[["Plots"]] + labs(title = "Initial curve"))
}

if (!is.null(ResultList$wbResult[["TruncatedPlots"]])) {
  print(ResultList$wbResult[["TruncatedPlots"]] + labs(title = "Truncated curve"))
}

if (!is.null(ResultList$wbResult[["AUCdf"]])) {
  DT::datatable(ResultList$wbResult[["AUCdf"]])
}


```

### WB comparison

### Normalizer WB 

```{r, echo=FALSE}
if (!is.null(ResultList$wbquantResult[["NormWBanalysis_filtered"]])) {
  DT::datatable(ResultList$wbquantResult[["NormWBanalysis_filtered"]])
}

if (!is.null(ResultList$wbquantResult[["WBanalysis_filtered"]])) {
  DT::datatable(ResultList$wbquantResult[["WBanalysis_filtered"]])
}

if (!is.null(ResultList$wbquantResult[["RelDensitiy"]])) {
  DT::datatable(ResultList$wbquantResult[["RelDensitiy"]])
}

if (!is.null(ResultList$wbquantResult[["AdjRelDensitiy"]])) {
  DT::datatable(ResultList$wbquantResult[["AdjRelDensitiy"]])
}

```